/*!CK:1539936559!*//*1386598028,173209415*/

if (self.CavalryLogger) { CavalryLogger.start_js(["uj9U\/"]); }

__d("InnerStickyFooter",["ArbiterMixin","ContextualLayer","CSS","DataStore","DOM","Event","LayerHideOnTransition","Locale","Parent","Style","Vector","cx","mixin","removeFromArray"],function(a,b,c,d,e,f){var g=b('ArbiterMixin'),h=b('ContextualLayer'),i=b('CSS'),j=b('DataStore'),k=b('DOM'),l=b('Event'),m=b('LayerHideOnTransition'),n=b('Locale'),o=b('Parent'),p=b('Style'),q=b('Vector'),r=b('cx'),s=b('mixin'),t=b('removeFromArray');function u(aa){var ba=o.byClass(aa,'scrollable')||p.getScrollParent(aa.parentNode);return ba;}var v=s(g);for(var w in v)if(v.hasOwnProperty(w))y[w]=v[w];var x=v===null?null:v.prototype;y.prototype=Object.create(x);y.prototype.constructor=y;y.__superConstructor__=v;function y(aa){"use strict";var ba=u(aa);this.node=aa;this._extracted=false;this._placeholder=k.create('div',{className:"_ptr"});z.getInstance(ba).register(this);}y.prototype.update=function(){"use strict";if(this._extracted){q.getElementDimensions(this._placeholder).setElementWidth(this.node);q.getElementDimensions(this.node).setElementHeight(this._placeholder);}else q.getElementDimensions(this.node).setElementWidth(this.node).setElementHeight(this._placeholder);return this;};y.prototype.setExtracted=function(aa){"use strict";if(aa===this._extracted)return this;if(aa){this.update();k.replace(this.node,this._placeholder);}else{p.set(this.node,'height',null);p.set(this.node,'width',null);if(this._placeholder.parentNode){k.replace(this._placeholder,this.node);}else k.remove(this.node);}this._extracted=aa;this.inform('extract_change',{extracted:aa});return this;};y.prototype.getInlineNode=function(){"use strict";return this._extracted?this._placeholder:this.node;};y.prototype.getStickyContainer=function(){"use strict";return this._stickyContainer;};y.prototype.updateContainer=function(){"use strict";var aa=u(this.node);z.getInstance(aa).register(this);};y.getStickyContainer=function(aa){"use strict";return z.getInstance(u(aa));};function z(aa){"use strict";this.node=aa;this._areas=[];this._fixTarget=null;this._fixedArea=null;this._initialized=false;this._layer=new h({permanent:true},k.create('div')).setInsertParent(this.node.parentNode).setPosition('below').disableBehavior(m);this._listener=l.listen(aa,'scroll',this.update.bind(this));i.addClass(aa,"_pts");j.set(aa,'StickyFooterContainer',this);}z.prototype.isDisplayed=function(){"use strict";return this.node.offsetParent!==null;};z.prototype.register=function(aa){"use strict";if(aa.getStickyContainer())aa.getStickyContainer().unregister(aa);aa._stickyContainer=this;this._areas.push(aa);this.update();return this;};z.prototype.unregister=function(aa){"use strict";t(this._areas,aa);this.update();};z.prototype.update=function(){"use strict";if(!this.isDisplayed())return this;var aa=null,ba=this,ca=this.node.scrollTop,da;for(var ea=0;ea<this._areas.length;ea++){var fa=this._areas[ea],ga=fa.getInlineNode();if(!k.contains(this.node.parentNode,ga))continue;var ha=ga.offsetTop+ga.offsetHeight;if(ha>=ca+this.node.offsetHeight){if(!da||ha<da){aa=fa;da=ha;}}else if(aa||(this._fixedArea&&fa!==this._fixedArea)){aa=aa||this._fixedArea;var ia=q.getElementDimensions(aa.node).y;if(ha+ia>ca+this.node.offsetHeight){ba=fa;if(this._fixedArea===fa)aa=null;}}}if(this._fixedArea===aa&&this._fixTarget===ba){if(this._fixedArea&&this._fixedArea!==this._currentFixedArea){this._currentFixedArea=this._fixedArea;this._fixedArea.update();}}else{if(this._fixedArea&&this._fixedArea!==aa)this._unfixArea(this._fixedArea);if(aa)this._fixAreaTo(aa,ba);this._fixedArea=aa;this._fixTarget=ba;}return this;};z.prototype.forceUpdate=function(){"use strict";if(this._fixedArea)this._fixedArea.update();return this;};z.prototype.destroy=function(){"use strict";this._listener&&this._listener.remove();this._listener=null;};z.prototype._fixAreaTo=function(aa,ba){"use strict";this._layer.hide();aa.setExtracted(true);if(ba instanceof z){this._layer.setInsertParent(this.node.parentNode).setAlignment(n.isRTL()?'right':'left').setContext(this.node);}else this._layer.setInsertParent(this.node).setContext(ba.node);this._layer.setContent(aa.node).show();};z.prototype._unfixArea=function(aa){"use strict";this._layer.hide();aa.setExtracted(false);};z.getInstance=function(aa){"use strict";var ba=j.get(aa,'StickyFooterContainer');return ba||new z(aa);};e.exports=y;});